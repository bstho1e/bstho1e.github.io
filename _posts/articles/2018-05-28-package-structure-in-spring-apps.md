---
layout: post
title: "Package structure in Spring apps"
excerpt:
modified: 2018-05-28 18:56:18 +0300
categories: articles
tags: [spring, java]
image:
  feature:
  credit:
  creditlink:
comments: true
share: true
published: false
aging: false
---

* Tightly coupled classes belong in the same package

We use public access modifier all the time because we package our classes by layers.
We have to possibility to encapsulate classes inside packages.
Using a layered approach, we intentionally give this benefit away.

Because we use layers, everything needs to be public.
A repository class needs to be public because we want to access it from the service layer.
Although it might not make sense to access the repository from anywhere else than a specific service class.
We could enforce this by having them in the same package and making the repository package-private.

When we have everything public, we lose the benefit of encapsulation.
It becomes hard to enforce what classes can use what other classes.
The more dependents you have for a class, the harder it becomes to change it.
There's a higher likelihood that we break something.

## Whoops, where did my architecture go

* Layered approach to separate code is technical in nature and does not reflect the domain
* On the other hand, this is widely used and understood
* It's easy to introduce an architecture violation in a monolith with layers, you call some class that you should not have access to
* Because of layers first approach, our classes need to be public. And because they're public, It's very easy to introduce a dependency we'd like to avoid
* Slices first approach - only types that need to be public can be kept public, others can be package private
* Default visibility for classes generated by IDE's is `public`, although in the Java language the default is `package-private`
